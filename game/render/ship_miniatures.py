"""Simplified top-down silhouettes for ship HUD miniatures."""

from __future__ import annotations

from dataclasses import dataclass
from typing import Dict, Sequence, Tuple


Coordinate = Tuple[float, float]
Line = Tuple[Coordinate, Coordinate]


@dataclass(frozen=True)
class ShipMiniature:
    """Data describing how to draw a miniature top-down ship silhouette."""

    outline: Sequence[Coordinate]
    detail_lines: Sequence[Line] = ()
    engine_points: Sequence[Coordinate] = ()


DEFAULT_MINIATURE = ShipMiniature(
    outline=[
        (0.0, 1.0),
        (-0.5, 0.45),
        (-0.32, -0.05),
        (-0.24, -0.55),
        (-0.1, -0.95),
        (0.0, -1.0),
        (0.1, -0.95),
        (0.24, -0.55),
        (0.32, -0.05),
        (0.5, 0.45),
    ],
    detail_lines=(
        ((0.0, 1.0), (0.0, -1.0)),
        ((-0.32, 0.2), (0.32, 0.2)),
        ((-0.2, -0.55), (0.2, -0.55)),
    ),
    engine_points=((-0.18, -0.95), (0.18, -0.95)),
)


SHIP_MINIATURES: Dict[str, ShipMiniature] = {
    "viper_mk_ii": ShipMiniature(
        outline=[
            (0.0, 1.0),
            (-0.32, 0.78),
            (-0.46, 0.32),
            (-0.28, -0.12),
            (-0.2, -0.55),
            (-0.08, -0.92),
            (0.0, -1.0),
            (0.08, -0.92),
            (0.2, -0.55),
            (0.28, -0.12),
            (0.46, 0.32),
            (0.32, 0.78),
        ],
        detail_lines=(
            ((0.0, 1.0), (0.0, -1.0)),
            ((-0.32, 0.3), (0.32, 0.3)),
            ((-0.22, -0.4), (0.22, -0.4)),
        ),
        engine_points=((-0.16, -0.96), (0.16, -0.96)),
    ),
    "viper_mk_vii": ShipMiniature(
        outline=[
            (0.0, 1.0),
            (-0.26, 0.82),
            (-0.4, 0.34),
            (-0.24, -0.08),
            (-0.18, -0.5),
            (-0.06, -0.94),
            (0.06, -0.94),
            (0.18, -0.5),
            (0.24, -0.08),
            (0.4, 0.34),
            (0.26, 0.82),
        ],
        detail_lines=(
            ((0.0, 1.0), (0.0, -1.0)),
            ((-0.26, 0.35), (0.26, 0.35)),
            ((-0.18, -0.35), (0.18, -0.35)),
        ),
        engine_points=((-0.14, -0.95), (0.14, -0.95)),
    ),
    "viper_mk_iii": ShipMiniature(
        outline=[
            (0.0, 1.0),
            (-0.36, 0.76),
            (-0.52, 0.26),
            (-0.38, -0.06),
            (-0.32, -0.4),
            (-0.24, -0.78),
            (-0.08, -0.98),
            (0.08, -0.98),
            (0.24, -0.78),
            (0.32, -0.4),
            (0.38, -0.06),
            (0.52, 0.26),
            (0.36, 0.76),
        ],
        detail_lines=(
            ((0.0, 1.0), (0.0, -1.0)),
            ((-0.36, 0.2), (0.36, 0.2)),
            ((-0.26, -0.32), (0.26, -0.32)),
        ),
        engine_points=((-0.2, -0.96), (0.2, -0.96)),
    ),
    "raptor_fr": ShipMiniature(
        outline=[
            (0.0, 0.92),
            (-0.28, 0.88),
            (-0.6, 0.44),
            (-0.7, 0.12),
            (-0.7, -0.22),
            (-0.52, -0.52),
            (-0.38, -0.78),
            (-0.2, -0.94),
            (0.0, -1.0),
            (0.2, -0.94),
            (0.38, -0.78),
            (0.52, -0.52),
            (0.7, -0.22),
            (0.7, 0.12),
            (0.6, 0.44),
            (0.28, 0.88),
        ],
        detail_lines=(
            ((0.0, 0.9), (0.0, -1.0)),
            ((-0.6, 0.1), (0.6, 0.1)),
            ((-0.38, -0.48), (0.38, -0.48)),
        ),
        engine_points=((-0.28, -0.92), (0.28, -0.92)),
    ),
    "rhino_strike": ShipMiniature(
        outline=[
            (0.0, 0.98),
            (-0.4, 0.9),
            (-0.6, 0.55),
            (-0.62, 0.18),
            (-0.5, -0.2),
            (-0.44, -0.56),
            (-0.36, -0.8),
            (-0.18, -1.0),
            (0.18, -1.0),
            (0.36, -0.8),
            (0.44, -0.56),
            (0.5, -0.2),
            (0.62, 0.18),
            (0.6, 0.55),
            (0.4, 0.9),
        ],
        detail_lines=(
            ((0.0, 0.98), (0.0, -1.0)),
            ((-0.48, 0.18), (0.48, 0.18)),
            ((-0.34, -0.4), (0.34, -0.4)),
        ),
        engine_points=((-0.24, -0.96), (0.24, -0.96)),
    ),
    "raven_mk_vi_r": ShipMiniature(
        outline=[
            (0.0, 1.0),
            (-0.3, 0.76),
            (-0.52, 0.32),
            (-0.48, -0.04),
            (-0.34, -0.46),
            (-0.22, -0.78),
            (-0.08, -0.96),
            (0.0, -1.0),
            (0.08, -0.96),
            (0.22, -0.78),
            (0.34, -0.46),
            (0.48, -0.04),
            (0.52, 0.32),
            (0.3, 0.76),
        ],
        detail_lines=(
            ((0.0, 1.0), (0.0, -1.0)),
            ((-0.48, 0.0), (0.48, 0.0)),
            ((-0.28, -0.52), (0.28, -0.52)),
        ),
        engine_points=((-0.18, -0.96), (0.18, -0.96)),
    ),
    "glaive_command": ShipMiniature(
        outline=[
            (0.0, 1.0),
            (-0.28, 0.88),
            (-0.48, 0.6),
            (-0.58, 0.22),
            (-0.6, -0.12),
            (-0.54, -0.46),
            (-0.4, -0.74),
            (-0.22, -0.92),
            (0.0, -1.0),
            (0.22, -0.92),
            (0.4, -0.74),
            (0.54, -0.46),
            (0.6, -0.12),
            (0.58, 0.22),
            (0.48, 0.6),
            (0.28, 0.88),
        ],
        detail_lines=(
            ((0.0, 1.0), (0.0, -1.0)),
            ((-0.5, 0.18), (0.5, 0.18)),
            ((-0.32, -0.46), (0.32, -0.46)),
        ),
        engine_points=((-0.24, -0.94), (0.24, -0.94)),
    ),
    "scythe_interceptor": ShipMiniature(
        outline=[
            (0.0, 1.0),
            (-0.24, 0.88),
            (-0.5, 0.58),
            (-0.6, 0.2),
            (-0.52, -0.14),
            (-0.38, -0.42),
            (-0.25, -0.72),
            (-0.08, -0.95),
            (0.0, -1.0),
            (0.08, -0.95),
            (0.25, -0.72),
            (0.38, -0.42),
            (0.52, -0.14),
            (0.6, 0.2),
            (0.5, 0.58),
            (0.24, 0.88),
        ],
        detail_lines=(
            ((0.0, 1.0), (0.0, -1.0)),
            ((-0.5, 0.22), (0.5, 0.22)),
            ((-0.3, -0.48), (0.3, -0.48)),
        ),
        engine_points=((-0.2, -0.96), (0.2, -0.96)),
    ),
    "maul_assault": ShipMiniature(
        outline=[
            (0.0, 0.96),
            (-0.28, 0.96),
            (-0.52, 0.72),
            (-0.66, 0.36),
            (-0.68, -0.04),
            (-0.66, -0.36),
            (-0.54, -0.64),
            (-0.4, -0.86),
            (-0.2, -0.98),
            (0.2, -0.98),
            (0.4, -0.86),
            (0.54, -0.64),
            (0.66, -0.36),
            (0.68, -0.04),
            (0.66, 0.36),
            (0.52, 0.72),
            (0.28, 0.96),
        ],
        detail_lines=(
            ((0.0, 0.96), (0.0, -0.98)),
            ((-0.62, 0.0), (0.62, 0.0)),
            ((-0.46, -0.46), (0.46, -0.46)),
        ),
        engine_points=((-0.28, -0.94), (0.28, -0.94)),
    ),
    "vanir_command": ShipMiniature(
        outline=[
            (0.0, 1.0),
            (-0.3, 0.92),
            (-0.5, 0.62),
            (-0.62, 0.24),
            (-0.62, -0.16),
            (-0.58, -0.46),
            (-0.48, -0.7),
            (-0.32, -0.9),
            (-0.12, -1.0),
            (0.12, -1.0),
            (0.32, -0.9),
            (0.48, -0.7),
            (0.58, -0.46),
            (0.62, -0.16),
            (0.62, 0.24),
            (0.5, 0.62),
            (0.3, 0.92),
        ],
        detail_lines=(
            ((0.0, 1.0), (0.0, -1.0)),
            ((-0.58, 0.2), (0.58, 0.2)),
            ((-0.4, -0.46), (0.4, -0.46)),
        ),
        engine_points=((-0.24, -0.98), (0.24, -0.98)),
    ),
    "brimir_carrier": ShipMiniature(
        outline=[
            (0.0, 1.0),
            (-0.4, 0.96),
            (-0.7, 0.72),
            (-0.78, 0.44),
            (-0.8, 0.08),
            (-0.8, -0.2),
            (-0.74, -0.52),
            (-0.64, -0.76),
            (-0.46, -0.94),
            (-0.24, -1.0),
            (0.24, -1.0),
            (0.46, -0.94),
            (0.64, -0.76),
            (0.74, -0.52),
            (0.8, -0.2),
            (0.8, 0.08),
            (0.78, 0.44),
            (0.7, 0.72),
            (0.4, 0.96),
        ],
        detail_lines=(
            ((0.0, 1.0), (0.0, -1.0)),
            ((-0.72, 0.08), (0.72, 0.08)),
            ((-0.5, -0.5), (0.5, -0.5)),
        ),
        engine_points=((-0.34, -0.98), (0.0, -0.98), (0.34, -0.98)),
    ),
    "outpost_regular": ShipMiniature(
        outline=[
            (0.0, 0.85),
            (-0.25, 0.85),
            (-0.25, 0.5),
            (-0.55, 0.5),
            (-0.55, 0.22),
            (-0.85, 0.22),
            (-0.85, -0.22),
            (-0.55, -0.22),
            (-0.55, -0.5),
            (-0.25, -0.5),
            (-0.25, -0.85),
            (0.25, -0.85),
            (0.25, -0.5),
            (0.55, -0.5),
            (0.55, -0.22),
            (0.85, -0.22),
            (0.85, 0.22),
            (0.55, 0.22),
            (0.55, 0.5),
            (0.25, 0.5),
            (0.25, 0.85),
        ],
        detail_lines=(
            ((-0.85, 0.0), (0.85, 0.0)),
            ((0.0, 0.85), (0.0, -0.85)),
        ),
        engine_points=(),
    ),
}


def get_ship_miniature(frame_id: str) -> ShipMiniature:
    """Return the miniature definition for the given ship frame id."""

    if not frame_id:
        return DEFAULT_MINIATURE
    return SHIP_MINIATURES.get(frame_id, DEFAULT_MINIATURE)


__all__ = ["ShipMiniature", "get_ship_miniature", "DEFAULT_MINIATURE", "SHIP_MINIATURES"]

